<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Restablece tu contraseña para acceder de forma segura a nuestro sistema IDS.">
    <title>Restablecer Contraseña - IDS Pro</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');

        :root {
            /* Tema Claro */
            --bg-color: #f4f7f9;                   /* Fondo general claro */
            --container-bg-color: #ffffff;           /* Contenedor blanco */
            --primary-accent-color: #007bff;         /* Azul primario (similar al anterior, pero puedes cambiarlo) */
            --primary-accent-hover-color: #0056b3;
            --text-color-dark: #212529;             /* Texto principal oscuro */
            --text-color-medium: #495057;           /* Texto secundario */
            --text-color-light-placeholder: #6c757d; /* Placeholder y texto muy claro */
            --border-color: #dee2e6;
            --input-bg-color: #ffffff;
            --input-focus-border: var(--primary-accent-color);
            --input-focus-shadow: rgba(0, 123, 255, 0.2);

            /* Colores de Alerta para Tema Claro */
            --success-bg: #d1e7dd; --success-text: #0f5132; --success-border: #badbcc;
            --danger-bg: #f8d7da;  --danger-text: #721c24;  --danger-border: #f5c2c7;
            --info-bg: #cff4fc;    --info-text: #055160;    --info-border: #b6effb;
            --warning-bg: #fff3cd; --warning-text: #664d03; --warning-border: #ffecb5;
            
            --footer-bg-color: #e9ecef; /* Fondo opcional para el footer */
            --footer-text-color: var(--text-color-medium);
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color-medium);
            display: flex;
            flex-direction: column; /* Clave para el sticky footer */
            min-height: 100vh;      /* Clave para el sticky footer */
            margin: 0;
            box-sizing: border-box;
            line-height: 1.6;
        }

        .main-content-wrapper {
            flex: 1; /* Clave para el sticky footer, empuja el footer hacia abajo */
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px; /* Padding alrededor del contenedor principal */
            box-sizing: border-box;
            width: 100%;
        }

        .container {
            background-color: var(--container-bg-color);
            padding: 35px 45px;
            border-radius: 10px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            width: 100%;
            max-width: 480px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .container h1 {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--text-color-dark);
            font-size: 2em;
            font-weight: 700;
        }

        .container .subtitle {
            margin-bottom: 30px;
            color: var(--text-color-medium);
            font-size: 0.95em;
        }

        .flashes {
            margin-bottom: 25px;
            width: 100%;
        }

        .alert {
            padding: 15px 20px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 8px;
            font-size: 0.95em;
            text-align: left;
            display: flex;
            align-items: center;
        }
         .alert strong {
            font-weight: 500;
            margin-right: 8px;
        }

        .alert-success { background-color: var(--success-bg); color: var(--success-text); border-color: var(--success-border); }
        .alert-danger  { background-color: var(--danger-bg);  color: var(--danger-text);  border-color: var(--danger-border); }
        .alert-info    { background-color: var(--info-bg);    color: var(--info-text);    border-color: var(--info-border); }
        .alert-warning { background-color: var(--warning-bg); color: var(--warning-text); border-color: var(--warning-border); }
        .alert-message { background-color: var(--info-bg);    color: var(--info-text);    border-color: var(--info-border); }


        form {
            display: flex;
            flex-direction: column;
        }

        .form-group {
            margin-bottom: 25px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-color-dark);
            font-weight: 500; /* Ajustado para tema claro */
            font-size: 0.9em;
        }
        
        .form-control {
            width: 100%;
            padding: 13px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1em;
            color: var(--text-color-dark);
            background-color: var(--input-bg-color);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .form-control::placeholder {
            color: var(--text-color-light-placeholder);
            font-weight: 300;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--input-focus-border);
            box-shadow: 0 0 0 3.5px var(--input-focus-shadow);
        }

        .btn {
            padding: 14px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 1.05em;
            font-weight: 500;
            transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
            letter-spacing: 0.3px;
        }

        .btn-primary {
            background-color: var(--primary-accent-color);
            color: #ffffff; /* Texto blanco para buen contraste con el azul primario */
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
        }

        .btn-primary:hover {
            background-color: var(--primary-accent-hover-color);
            box-shadow: 0 6px 16px rgba(0, 123, 255, 0.2);
        }
        .btn-primary:active {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.15);
        }

        .navigation-links {
            margin-top: 30px;
            font-size: 0.9em;
        }
        .navigation-links a {
            color: var(--primary-accent-color);
            text-decoration: none;
            font-weight: 500;
        }
        .navigation-links a:hover {
            text-decoration: underline;
            color: var(--primary-accent-hover-color);
        }
        
        .site-footer {
            flex-shrink: 0; /* Clave para el sticky footer: no se encoge */
            width: 100%;
            padding: 20px;
            text-align: center;
            background-color: var(--footer-bg-color); /* Fondo opcional */
            color: var(--footer-text-color);
            font-size: 0.85em;
            box-sizing: border-box;
            border-top: 1px solid var(--border-color);
        }

    </style>
    </head>
<body>
    <div class="main-content-wrapper">
        <div class="container">
            <h1>Restablecer Acceso</h1>
            <p class="subtitle">
                La seguridad y disponibilidad de tu cuenta son nuestra prioridad.
                Ingresa tu correo electrónico registrado para iniciar el proceso de recuperación.
                Te enviaremos un enlace seguro y de tiempo limitado.
            </p>

            {# BLOQUE PARA MENSAJES FLASH DE FLASK #}
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                <div class="flashes">
                  {% for category, message_text in messages %}
                    <div class="alert alert-{{ category if category else 'info' }}">
                      {{ message_text }}
                    </div>
                  {% endfor %}
                </div>
              {% endif %}
            {% endwith %}

            <form method="POST" action="{{ url_for('login.forgot_password') }}">
                <div class="form-group">
                    <label for="email">Correo Electrónico:</label>
                    <input type="email" id="email" name="email" class="form-control" required placeholder="tu_correo@sistema.com">
                </div>
                <button type="submit" class="btn btn-primary">Enviar Enlace de Recuperación</button>
            </form>

            <div class="navigation-links">
                <a href="{{ url_for('login.home') }}">‹ Volver a Inicio de Sesión</a>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        &copy; {% block year %}{{ now().year if now else '2025'}}{% endblock %} IDS Profesional. Comprometidos con tu seguridad.
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const successAlert = document.querySelector('.alert-success');
            const loginUrl = "{{ url_for('login.home', _external=True) }}"; 

            if (successAlert && successAlert.offsetParent !== null) { 
                setTimeout(function() {
                    window.location.href = loginUrl;
                }, 5000); // Redirige después de 5 segundos
            }
        });
    </script>
    {# Para que now().year funcione, necesitas un procesador de contexto en Flask:
       from datetime import datetime
       @app.context_processor
       def utility_processor():
           return dict(now=datetime.utcnow)
       O simplemente reemplaza con el año actual directamente.
    #}
</body>
</html>